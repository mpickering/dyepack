os:
- linux
language: nix
nix: 2.2.1
env:
  global:
    # github
    # cachix
    - secure: "zTI66/WRubaNh6gIeZAkh5GuPbP1Pak5vG0UNapxAEK9F419ZYBerZio4gbDtYZQ67qwC4LiQZpTbcAiP2X5cS8Jl5et1N4h6Mq3wokkQNRgOVZMoA3tNhgIEZ/Alv+9Mq7TEc1dI9vWouyjAR1WpDMXT9vec0NuNWzJqATKl3lPkNnR844Jia0FT5HWSvcBNvCfclB1fp+mJ4xz1x587Jbtaa05ptgX6vg7qfbdC8hB3r7x4lL1iNU90qfBLOVt8dTkijb76p+181U6Di4k8R5V5PTlmcW6UXtMig6bNq6AORk3Lwe8vkouDmATX4ma6sefbS5IGI5Uy3/glJacmfV/ZMadCVaLD+wKtgkj0lFnG6fhfXZURVbHBBIIrcNEnyFiaSgBs226aozN/SSmKymKMRluK6UmSjmiw9IP5z5gBwK2ZFSdhWMEGzKUYmJSIhC/I5W8Bc5KVpx/i5Ku2AbIpRZkBgx/yl6znEJw7aoMrMnLXjnht0jP+C4J2wItt4TzzOFkktGbEkzndX3z9TcHBClD7lLbGemxFsGQYNpjeH7METM2OEkEmsN5HT0zaV1JFJNlGKhIHce54zOZjQ+gU7Mqo1Zy6o3IExU8DzCpMwyX9o8N7Xqy3ygTIBhM/GAHCmM7lY95YgsdsWOVFBnxWgw8dsidLSI6ecHl6/g="

jobs:
  include:
    - stage: build library
      script:
        - nix-env -iA cachix -f https://cachix.org/api/v1/install
        - cachix use mpickering
        - cachix push mpickering --watch-store&
        - nix-build -A dyepack

#    - stage: build documentation
#      if: false
#      script:
#        - nix-env -iA cachix -f https://cachix.org/api/v1/install
#        - cachix use mpickering
#        - cachix push mpickering --watch-store&
#        - nix-build -A site -o site
#
#      deploy:
#        provider: pages
#        skip_cleanup: true
#        github_token: $GITHUB_TOKEN
#        keep_history: true
#        target_branch: gh-pages
#        local_dir: site
#        on:
#          tags: true

